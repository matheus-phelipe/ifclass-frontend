<app-profile-switcher></app-profile-switcher>
<div class="vinculo-main-container">
  <h2><i class="bi bi-people"></i> VÃ­nculo Professor x Disciplinas</h2>
  <div *ngIf="erro" class="erro"><i class="bi bi-exclamation-circle"></i> {{ erro }}</div>
  <div class="professores-cards">
    <div class="prof-card" *ngFor="let prof of professores">
      <div class="prof-header">
        <div class="prof-avatar"><i class="bi bi-person-circle"></i></div>
        <div class="prof-info">
          <div class="prof-nome">{{ prof.nome }}</div>
          <div class="prof-email">{{ prof.email }}</div>
        </div>
        <button class="btn-toggle" (click)="selecionarProfessorPorId(prof.id.toString())" [disabled]="carregando || !podeEditar">
          <i class="bi" [ngClass]="professorSelecionado?.id === prof.id ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
        </button>
      </div>
      <div class="prof-disciplinas" *ngIf="professorSelecionadoId === prof.id">
        <div *ngIf="carregando" class="carregando"><span class="loader"></span> Carregando...</div>
        <div *ngIf="!carregando">
          <div class="disciplinas-chips">
            <span class="disciplina-chip" *ngFor="let disc of disciplinasVinculadas">{{ disc.nome }}</span>
            <span *ngIf="disciplinasVinculadas.length === 0" class="nenhuma-disciplina">Nenhuma disciplina vinculada.</span>
          </div>
          <div class="disciplinas-vinculo-list" *ngIf="podeEditar">
            <div class="vinculo-item" *ngFor="let disc of disciplinas">
              <span>{{ disc.nome }}</span>
              <label class="switch">
                <input type="checkbox" [checked]="estaVinculada(disc)" (change)="alternarVinculo(disc)" [disabled]="carregando || !podeEditar">
                <span class="slider round"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
